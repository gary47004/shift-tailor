


###國立政治大學資訊管理學系 2016年專題發表會 第12組 專題報告書 
#專題名稱： Shift Tailor——智慧排班師

專題成員：
資管四甲 林聖翔,
資管四乙 王宥翔,
資管四乙 侯雅方,
資管四甲 葉浩平

##摘要
在以兼職人員為主的服務業中，排班作業一直都是令人資經理頭痛的問題，傳統的人工排班為了產出一張班表往往耗時費力，人資經理需先收集員工的資訊，經過重複核對、調解再透過經驗法則將班表產出，過程繁瑣、缺乏效率、無標準程序，無公正性也容易出現人為疏失。以員工福祉與管理便利性為導向，我們的團隊藉由混合整數規劃演算模型設計出將員工的資深度、對時間的偏好納入考量的智慧型排班系統，再結合Beacon技術並迎合智慧手機的趨勢，將排班作業集合人資管理功能做出此款公平、合理、人性化的手機應用程式。

##壹、專題簡介


####一、專案動機
在服務業中的兼職人員以學生為主要族群，組員中四位即有三位有在咖啡館做過Part Time的經驗（星巴克、路易莎、Spacebar Room）。就觀察，現在業者普遍還是採用傳統紙本登記，在使用人工腦力或Excel的內建函式產出班表，過程中可能發生員工漏填、鍵入錯誤等疏失，排班方式也可能因為店長個人偏好或方法邏輯不完善而造成班表有非最佳解或不公正的疑慮。而每月薪資結算時，若發生員工請假、跨店調班、加班等狀況，總要花費數日將班表資料與打卡記錄一一核對，針對缺勤異常加以調整，再依不同時段給予不同時薪單位。

####二、專案目的
就上述情況，我們認為利用管理科學知識與演算模型將運算邏輯公式化，運用程式語言進行求解，以手機程式為平台將班表生產流程標準化、自動化以便提升效率和維持班表品質與公正性，最後再整和公告、薪資、打卡等人事管理功能。

####三、專案特色
	-排班自動化：利用線性規劃去除傳統人力排班可能造成的疏失
	-員工福祉最大化：將員工喜好度納入演算模型、自訂上班提醒
	-Beacon打卡系統：在行動裝置上，使用藍牙技術取代既有方法
	-管理功能整合：整合公告、薪資計算、出勤記錄等功能至一系統
	-跨店調撥：透過資料庫將所有分店的班表串連，使調撥一鍵完成

####四、商業價值
此款行動裝置應用程式的商業模式為B2B，對於服務業者，我們提供服務並向其收取費用。

##貳、需求分析與分工說明

####一、需求分析
經過訪談星巴克與路易莎的店長，我們得知在收到員工填妥的班表後，每週平均花費二到三個小時紙上或利用Excel函式排班，若要調撥分店可直接聯絡別的門市，通知後得到回應所需時間為三到四天，整個排班過程繁瑣冗長，店長為了在有限時間內將班表產出，通常直接依照經驗法則來排班，但因為人為疏失或運算邏輯不完善，產出的可能是可行解而非最佳解，每次排班無標準程序也可能造成員工對班表有公平上的疑慮，而最令店長頭痛的是臨時請假、代班、調撥、加班等會造成班表異動的狀況，除了要花時間與員工協調，因為班表最後要送往會計部門已計算薪資，所以任何更動都需重複核對註記。據此分析，有排班需求的服務業所需的是一套具標準化、能夠整合自動排班與人事管理功能且具便利性、即時性的系統。

####二、分工說明
-林聖翔——排班介面、調撥功能
-王宥翔——會員系統、通知功能、公告欄功能
-侯雅方——演算法分析、排班系統、伺服器架設
-葉浩平——打卡系統、資料庫建置

##參、系統架構與說明
####ㄧ、系統架構
#####（ㄧ）會員系統
使用者取得帳號後可依其登入系統，當使用者忘記密碼時有因應的機制來驗證身份。

#####（二）門市系統
首先，Shift Tailor將依照該公司之結構建立資料庫，並將其員工資料及公司資訊儲存，以提供排班及調撥時所需的資料。
另外，每個分區和分店都會有專屬的公告欄，所有員工可以在其所屬的公告欄中查看公告資訊。

#####（三）排班系統
店長端輸入人力需求與設定填表期限，讓員工端輸入此週期可上班時間，由後台系統的演算法計算出最佳解，並輸出該週期之班表，此班表在公佈前可以經過調整。有三種調整方式：
1. 手動調整：店長可直接更改班表
2. 內部詢問：詢問內部員工是否有意願上班
3. 外部調撥：對於人力缺乏的時段，店長可以發出通知，詢問 
附近分店員工是否願意在此時段來本店上班


#####（四）上班提醒
系統將依照使用者所設定之提醒時間，提醒使用者上班
	
#####（五）打卡系統
利用藍牙技術的打卡系統，可以將出缺勤資訊直接記錄在系統裡，讓使用者能在行動裝置上查詢記錄。

#####（六）薪資計算
由打卡系統的出缺勤紀錄來計算每位使用者之薪資。

####二、使用流程
(一)	前置流程
與公司洽談，取得公司內部之成員關係與資料，並由這些資料建製出該公司的資料庫。員工將收到手機簡訊，取得各自的帳號與密碼，下載App並登入後，即可開始使用功能。
(二)	使用流程
1. 查看班表：
使用者藉由正確的帳號密碼登入後，首頁即是班表。管理者可以看到店家當週的班表，而員工可見個人當週的班表。
2. 排班：
使用者點選排班按鈕，設定欲排班之期間，確認後進入排班介面，可設定各時段所需之職位和人數。完成上述步驟後，設定員工填表期限，即可送出排班需求及填表訊息。
3. 調整班表：
使用者可調整當週班表或尚未發布的班表。
a. 手動調整：使用者可手動新增或刪除當班員工，調整完
成後再發佈。
b. 內部詢問：新增該店員工前，選取回覆期限，再寄出訊
息。確認該員工之意願後，再將其排進班表。
c. 外部調撥：欲向他店調撥時，選取所需職業、人數，系
統將詢問可調撥門市員工和主管之意願，確認後使用者會得到可調撥清單，再選取欲調撥員工將其排進班表。
4. 填表：
使用者藉由填表功能，填寫自己可上班時間，及對該時間的喜好度。填表期限到期時，系統會依照該記錄排班。
5. 上班提醒：
使用者依其所設定之時間，將得到上班提醒訊息。
6. 公告：
使用者可於公告欄新增、查看、編輯公告。
7. 打卡：
使用者抵達可打卡區域後，開啟手機藍牙，偵測到Beacon即可成功打卡。
8. 員工資訊：
使用者可查看各員工薪資及出缺勤記錄。
9. 設定：
					a. 上班提醒設定：使用者可設定上班提醒之時間。
					b. 更改密碼：設定新密碼，驗證後可使用新密碼登入。
					c. 外部調撥設定：使用者可選取該區域門市清單內較偏好之
門市作為外部調撥時的順序依據。

####三、演算法
	理論基礎
	線上期刊：
			《Scheduling part-time personnel with availability restriction and
preference to maximize employee satisfaction》
	論文大綱：
    許多產業必須藉由雇用兼職人員來應變人力需求的零碎性，因此配置兼職人員的可上班時間是為研究重點。
	假設條件
	目標式採納：
	「可否上班」，availability
	「班別喜好度」，shift preference
	「資深度」，seniority
	若有必要，不排除讓「無法上班之員工」上班，會使目標式扣分
	員工可在一天之內上不同班別的班，且非必為連續
	一日工時有最大值、最小值；一週工時有最大值、最小值
	員工工時範圍限制



參數設定
表1、參數設定(1)
Indices	Definition	Explanation
i	Part-time employee	員工 i
j	Shift of the day	班別j
k	Day of the week	星期 k

表2、參數設定(2)
Parameters	Definition	Explanation
w_i	Seniority of employee i	員工i的資深度
b_jk	Number of employees needed for shift j on day k	星期k班別j的人力數量
t_jk	Length of shift j on day k	星期k班別j的班別時段
a_ijk	Current availability of employee i for shift j on day k	員工i在星期k班別j可否上班
p_ijk	Preference of employee i for shift j on day k	員工i在星期k班別j的喜好度
D_max	Maximum allowable working hours for an employee during a day	日工時最大值
D_min	Minimum allowable working hours for an employee during a day	日工時最小值
W_max	Maximum allowable working hours for an employee during a week	週工時最大值
W_min	Minimum allowable working hours for an employee during a week	週工時最小值

	決策變數
Y_ijk={█(1     if employee i is assigned to shift j on day k@0                                                                                               )┤
X_ik= {█(1      if employee i is hired on day k@0                                                                     )┤
	目標式
∑_i▒∑_j▒∑_k▒〖Y_ijk [(w_i∙a_ijk∙p_ijk )+(a_ijk  - 1) 〖 w〗_i]〗



	限制式
1. ∑_i▒Y_ijk = b_jk								∀j,  k
2. D_min∙X_ik≤∑_j▒〖(Y_ijk∙t_jk)≤〗  D_max		∀i, k
3. W_min≤∑_j▒〖∑_k▒〖(Y_ijk∙t_jk)〗≤W_max 〗			∀ i
4. Y_ijk≤X_ik								∀i,  j,  k
5. Y_ijk, X_ik  ∈ {0, 1}						∀i, j, k


























資料串接
 
圖3、前端與後端的串接

使用者將可上班時間傳至資料庫——Firebase儲存，伺服器——Node.js會至資料庫索取可上班時間之資訊，並透過JavaScript解析來自資料庫之資料，傳送給CPLEX做演算法運算。隨後CPLEX產出班表結果，再藉由JavaScript封裝班表資訊，Node.js會將班表回傳至資料庫，此時，使用者之行動裝置可依Firebase（Realtime Database）即時得到班表結果。

使用環境與工具
	 前端：Swift
	 資料庫：Firebase
	 線性規劃運算：IBM CPLEX
	 後端：Node.js、C++
結論與未來發展方向
一、結論
Shift Tailor是一款針對兼職人員差異性所設計的智慧排班手機APP，對員工我們強調排班的公平性，重視員工對工作時段的偏好以期能夠提升士氣；對主管我們強調班表運算自動化、人事管理整合。以手機APP作為操作平台兼具便利性與即時性，只需使用者簡單的操作，排班程序、打卡便能夠透過Shift Tailor完成動作，薪資出勤記錄、公司內的公告也能在Shift Tailor上發布、查看，排班作業、薪資計算等運算則在server處理後儲存於資料庫供未來使用，Shift Tailor不僅能省去排班作業衍生的麻煩，也將大幅降低人事管理成本，更能滿足勞資雙方的需求，營造更佳的工作環境，達成雙贏的局面。

	
 
二、未來發展方向
(一) 結合其他管理功能，如存貨管理、供應鏈管理等，使主管能夠透過單一
系統，達成整家店的管理機能
(二) 擴展人力管理系統：新增人力資源盤點功能，使主管能紀錄人員的缺編、
超編及是否符合職務資格要求，最後依照統計資料，給予主管人員人
力需求的參考數據
(三) 生活化、趣味性的獎勵制度：員工能依照該出缺勤紀錄得到虛擬貨幣，
主管也能依照工作績效，獎勵員工。而虛擬貨幣能兌換Shift Tailor的班
表介面主題、吉祥物提醒功能等獎品，使工作不再乏味，能保持愉悅的身
心。

















 
參考資料
一、 
Srimathy Mohan (2008), “Scheduling part-time personnel with availability 
restrictions and preference to maximize employee satisfaction”, Science Direct, available at http://www.sciencedirect.com/science/article/pii/S0895717708000526 (accessed 11 June 2016).

	二、
	武翠芳 (2010)，智慧型排班系統之設計——以服務業為例，國立中央大學
人力資源管理研究所碩士論文。


